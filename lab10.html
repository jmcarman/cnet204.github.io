<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="author" content="Jason Carman">
	<meta name="description" content="CNET204 Lab 10">
	<meta name="keywords" content="cnet204,centennial college,HTML5,CSS3">
	<meta charset="utf-8">
    <title>Lab 10</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<nav>
    <ul>
		<li><a href="index.html">Schedule</a></li>
		<li><a href="lab1.html">Lab 1</a></li>
        <li><a href="lab2.html">Lab 2</a></li>
        <li><a href="lab3.html">Lab 3</a></li>
        <li><a href="lab4.html">Lab 4</a></li>
		<li><a href="lab5.html">Lab 5</a></li>
		<li><a href="lab6.html">Lab 6</a></li>
		<li><a href="lab7.html">Lab 7</a></li>
		<li><a href="lab8.html">Lab 8</a></li>
		<li><a href="assignment1.html">Assignment 1</a></li>
		<li><a href="lab9.html">Lab 9</a></li>
		<li><a class="active" href="#">Lab 10</a></li>
		<li><a href="assignment2.html">Assignment 2</a></li>
		<li><a href="good.html">Good Formatting</a></li>
		<li><a href="bad.html">Bad Formatting</a></li>
   </ul>
</nav>
<main>
    <h1>Lab 10 - Introduction to PHP &amp; Forms</h1>
	<h2>Overview</h2>
    <p>This week's lab will cover the following:</p>
	<ul>
		<li>Installing PHP on your web server.</li>
		<li>Building HTML forms to collect user information.</li>
		<li>Using different types of input fields.</li>
		<li>Describing PHP syntax.</li>
		<li>Using PHP variables to store information.</li>
		<li>Using a PHP script to parse and validate form data.</li>
	</ul>

	<h2>Lecture Slides</h2>
	<div class="container">
		<iframe src="https://docs.google.com/presentation/d/e/2PACX-1vSreKvDGiuBX08Cqa9KYZvLKfUo58SyNf01viROvk6v1TPAHfuXTbXJFghVyeDKI0LDABKmxTCyqkmz/embed?start=false&loop=false&delayms=5000" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" frameborder="0" class="responsive-iframe"></iframe>
	</div>

	<h2>Introduction to PHP</h2>
	<h3>What is PHP?</h3>
	<p>PHP originally stood for Personal Home Page, but is now a recursive acryonym for PHP: Hypertext Preprocessor. It is a widely-used open source scripting language. PHP is a server-side scripting language, meaning scripts are executed on a server and the script's output is sent to the browser. It is free to download and use.</p>

	<h3>What is a PHP script?</h3>
	<p>A php script can contain text, HTML, CSS, JavaScript and PHP code. PHP supports two modes of use, any code written between the opening and closing PHP tags <strong>&lt;?php</strong> &amp; <strong>?&gt;</strong> will be interpreted as PHP. Anything outside of these tags is interpreted as HTML. While you can use built in functions such as print or echo to print out HTML within the PHP tags, it's generally considered bad form. Additionally, you lose the advantage of any color coding/tag matching your text editor does for the HTML as anything between single or double quotes in PHP comes out as all the same colour. PHP statements terminate with a semi-colon(;).</p>

	<p>PHP code is executed on the server, and the result is returned to the browser as plain HTML.	Unlike HTML or CSS, PHP code is not viewable in the browser by viewing page source. In order for PHP scripts to be interpreted properly by the server, the must have extension ".php".</p>

	<h2>Installing PHP</h2>
	<h3>Perform the following steps:</h3>
	
	<ul>
		<li>Start the AWS learner lab.</li>
		<li>Login to your www instance using SSH.</li>
	</ul>

	<p>Issue the following commands to update your system and install php.</p>
	<pre>sudo apt -y update; sudo apt -y install php</pre>

	<p>Issue the following command to confirm PHP has been installed.  You should see the output <strong>/usr/bin/php</strong></p>
	<pre>which php</pre>

	<h2>Creating your first PHP script</h2>
	<p>Using vi on your www instance, create a new file</p>
	<pre>sudo vi /var/www/html/hello.php</pre>
	
	<p>Insert the following code:</p>
	<pre>
	&lt;?php
		echo "Hello World!";
	?&gt;
	</pre>

	<h3>To do:</h3>
	<p>Open a web browser and access hello.php from your web server. What do you see? View the page source. What do you notice about the output?</p>

	<h2>Modifying a PHP script from a provided template</h2>
	<p>Open the file called form.php in your Labs6-10 repository. Notice some of the code has been provided for you (along with this file). Create the html portion of the page first to meet the following criteria. Refer to your previous lab instructions to do each of the following if needed.</p>
	<ol>
		<li>Use the HTML5 doctype declaration</li>
		<li>Set the Title to "Form", without the quotes</li>
		<li>Insert meta tags indicating the encoding (charset) of utf-8, viewport and the author to your name</li>
		<li>Insert a comment indicating your name and student number</li>
		<li>Link your style sheet to the page</li>
		<li>Make use of the main tag</li>
		<li>Copy your navigation bar from your index page and modify it to properly indicate your current page</li>
	</ol>
		
	<h2>Introducing html forms</h2>
	<p>Forms are used as a tool to take user input data and pass it to a program running on a server for server side processing. First you will create a form that will not interact with a server, as that requires a server side scripting language (such as PHP) for this. You will then add the PHP code to process the form.</p>

	<h2>Beginning your form</h2>
	<p>Forms begin and end with the &lt;form&gt; tag. They can contain several different tags, such as buttons and various types of input fields. The types of input fields have been expanded on substantially in HTML5.</p>
	
	<h2>Adding some attributes</h2>
	<p>The form tag has two commonly used attributes. These are action and method. Action defines the action to be performed when the form is submitted. This is always the name of the script on the server that will be processing your form.</p>
	<p>The method attribute specifies the HTTP method to be used when submitting the form data. This can be either GET or POST. When you submit a form using GET, the form data is sent in the packet header and is visible in the page address field. This should not be used if your data is sensitive. When you submit a form using POST, the form data is sent in the packet body and isn't visible in the page address field.</p>
	<h3>To do:</h3>
	<p>Add the method attribute to your form tag, and set it to "post". A sample of what you should have follows.</p>
	<pre>&lt;form method="post" action="form.php"&gt;</pre>
	<p>Add a heading level 1 tag, with the contents "User Registration"</p>
	
	<h2>About input fields</h2>
	<p>Some common input types are:</p>
	<ul>
		<li>text - will appear as plain text</li>
		<li>password - will display the input as centered dots to the user</li>
		<li>radio - will display a radio button, used for a single input in that selection</li>
		<li>checkbox - will display a check box, used for zero or more choices in that selection</li>
		<li>submit - will display a submit button</li>
		<li>reset - will display a reset button</li>
	</ul>
	<p>HTML5 adds several new input types, such as:</p>
	<ul>
		<li>date - allows the user to choose a date through a pop up calendar</li>
		<li>email - used to validate an email address client side</li>
		<li>tel - used to validate a telephone number client side</li>
	</ul>
	<p>For a more complete list of form input types, have a look at <a href="https://www.w3schools.com/html/html_form_input_types.asp">w3schools</a>.</p>
	
	<h2>Adding input fields</h2>
	<p>Add a field for First Name, with a type of text and a name of firstName</p>
	<pre>First Name: &lt;input type="text" name="firstName" value="&lt;?php echo $fName;?&gt;"&gt;&lt;span class="error"&gt;&lt;?php echo $fNameErr;?&gt;&lt;/span&gt;</pre>
	<p>Each input field must have a name attribute to be submitted. If you leave this out, the data from that field won't be sent to the server for processing. The embedded PHP code are the variables your PHP script will use. These will be explained later in the lab.</p>
	
	<h3>To do:</h3>
	<p>Using the above First Name input field syntax, and the input types described above that add the following fields to your form:</p>
	<ul>
		<li>Last Name with a type of text, a value of $lName, and error $lNameErr</li>
		<li>Email with a type of email, a value of $email, and error $emailErr</li>
		<li>Password with a type of password, a value of $password, and error $passwordErr</li>
		<li>Date of Birth with a type of date, a value of $dob, and error $dobErr</li>
		<li>Phone Number with a type of tel, a value of $phone, and error $phoneErr</li>
	</ul>
	
	<h2>Adding a dropdown list for province</h2>
	<p>Below your city input field, you are going to add a drop down list where the user can select their province. This requires a couple different tags. To create a dropdown list, use the &lt;select&gt; tag, as demonstrated below.</p>
	<pre>
		&lt;select name="province"&gt;
		&lt;/select&gt;
	</pre>
	<p>Notice the name parameter. This declares the name in the form data that would store the information - like a variable. You will use this to process your form with PHP. Ideally when learning server-side scripting, the variable in use on the server should match this for simplicity (but doesn't have to).</p>
	<p>Now it's time to add some options to our list. List options are encapsulated with an &lt;option&gt; tag, contain a value and text inbetween the opening and closing tag will appear as the option in the drop-down. Add the following option to your select list.</p>
	<pre>
		&lt;option value="Alberta"&gt;Alberta&lt;/option&gt;
	</pre>
	<p>Options will appear in the order you put them in. There is no way to sort them using html.</p>
	
	<h3>To do:</h3>
	<p>Using the above sample, add options to your list for the following provinces</p>
	<ol>
		<li>British Columbia</li>
		<li>Manitoba</li>
		<li>New Brunswick</li>
		<li>Newfoundland and Labrador</li>
		<li>Northwest Territories</li>
		<li>Nova Scotia</li>
		<li>Nunavut</li>
		<li>Ontario</li>
		<li>Prince Edward Island</li>
		<li>Quebec</li>
		<li>Saskatchewan</li>
		<li>Yukon</li>
	</ol>
	
	<h2>Form Finishing Touches</h2>
	<p>All your form needs now, are a submit and clear button, as well as the closing tag. Add the buttons using the following sample. Note whatever text you add to the value parameter, is what appears on the button.</p>
	<pre>
		&lt;input type="submit" name="submit" value="Submit"&gt;&lt;input type="reset" name="clear" value="Clear"&gt;
	</pre>
	<p>And finally, close your form with the &lt;/form&gt; tag.</p>
	<p>Save and view your page in the browser. Notice all the input boxes appear on one line, as they're in-line tags. You can clean this up a bit by adding some break tags at the end of each.</p>
	
	<h3>To do:</h3>
	<p>Make use of the &lt;br&gt; tag to clean up your form so it looks similar to the sample provided.</p>
	
	<h2>Stylizing your form with CSS</h2>
	<p>Forms have a lot of styling options that can be applied using CSS. Use the resources provided by <a href="https://www.w3schools.com/css/css_form.asp">w3schools</a> to apply some CSS to your form.</p>
	
	<h2>Parsing the form with PHP</h2>
	<p>Look at the PHP section of the form.php template you have been working in. Some code was provided, but most of it was left out and you were provided comments instead. Fill in the <strong>Author</strong> and <strong>Date</strong> information.</p>

	<h3>What is a variable?</h3>
	<p>A variable is a named location in memory used to store a value. The value can change over the course	of a script or program. Think similarly to algebra, where you assign x or y as an unknown value in an equation and solve for it. Unlike algebra, variables in programming are declared knowing how they're going to be used and what type of information will be stored in them. PHP supports dynamic or static typed variables.</p>

	<dl>
		<dt>Dynamic variables</dt>
		<dd>With dynamic typed variables, the program determines what type of data a variable contains based on the context it is used in.</dd>
		<dt>Static variables</dt>
		<dd>With static typed variables, you must declare a type when defining the variable. That variable can then only store that type of data. These are more secure in many ways, but a bit more difficult to deal with.</dd>
	</dl>

	<p>You will be using dynamic variables in this lab. It is recommended when using variables that you give them meaningful names that reflect the intended purpose. PHP has no command for declaring a variable, the variable is created when you assign a value to it.</p>

	<h3>PHP Variable Naming Rules</h3>
	<p>Variable names:</p>
	<ol>
		<li>Begin with the dollar sign($) followed by the name of the variable</li>
		<li>Can only begin with a letter or underscore</li>
		<li>Can be made up of letters, numbers or underscores</li>
		<li>Cannot be a reserved PHP command word</li>
		<li>Are case sensitive</li>
	</ol>

	<h3>Recommendations for naming variables</h3>
	<ol>
		<li>Declare all variables at the top of your file</li>
		<li>Do not use numbers. What is date1 vs. date2?</li>
		<li>Use descriptive terms like counter, name, price</li>
		<li>Camelcase is a common practice where you combine multiple words to form a variable, capitalizing the first letter of each word. IE: errorCounter, familyName, unitPriceDiscount</li>
	</ol>

	<p>To declare a variable, use the following syntax.</p>
	<pre>
		$varName = value;
	</pre>
	<p>If your value is a string, double quotes around it's entirety will tell the script to treat the whole thing together. Otherwise you may get syntax errors.</p>

	<h2>Initalizing the variables</h2>
	<p>You need to initilize all the variables you are going to use within the PHP script. Usually a programmer will do this as they go. However, since you are working from a planned example we can do that now. Find the comment in your code that matches the top line (below) and type the following (you will learn more than if you copy and paste).</p>
	<pre>
	# Initialize variables, without this you will get an error
	$fName = $fNameErr = 
	$lName = $lNameErr = 
	$email = $emailErr =
	$phone = $phoneErr =
	$dob = $dobErr =
	$password = $passwordErr =
	$province =
	$msg = "";
	$valid = FALSE;
	</pre>
	
	<h2>Conditional Logic (IF statements)</h2>
	<p>The <strong>if</strong> control structure is essential to programming and scripting. Regardless of what language you're learning to write your code in, the syntax means IF this condition is met DO this action. Whatever code that follows will only execute if the condition is met. You can include multiple IF statements within a code block using elseif, with a default instruction defined with else. Else conditions are executed if none of the previous conditions have been met.</p>

	<p>You're going to use an if statement to check if the form was submitted using the POST method (via the $_SERVER global variable, which is actually an array). If it was, you can start processing your form. Again, find the comment in your code that matches the top line (below).</p>
	<pre>
	# If the form was sent using the POST method
	if ($_SERVER["REQUEST_METHOD"] == "POST") {	
	</pre>

	<h2>Validating User Data</h2>
	<h3>When and Why to validate?</h3>
	<p>Any data that comes from an external source (usually via a form from a user) should be validated. Validation is the process of checking the data to ensure it contains the right information and in the correct format. This is done to ensure anything entered into a database is consistent. It also helps prevent malicious code like an SQL injection.</p>

	<h3>How to validate form data</h3>
	<p>Validating form data is a complicated task, and one suited for a lab unto itself. The process uses a combination of tools in conjunction with if statements to test data to ensure it meets specified requirements. You will do some very simple validation: if the field is not empty, the user has submitted something; so you can process the form.</p>

	<p>If the first name input is empty, set a meaningful error (to be displayed using the error variables you initilized above) and set the validation flag to FALSE.</p>
	<pre>
	# If first name is blank
	if ( empty($_POST["fName"]) ) {
		# Store the error message for first name in a variable
		$fNameErr = "* First Name cannot be empty";
		
		# Set valid to FALSE
		$valid = FALSE;
	</pre>

	<p>If (else if) the last name input is empty, repeat the above steps.</p>
	<pre>
	# Else if last name is blank
	} elseif ( empty($_POST["lName"]) ) {
		# Store the error message for last name in a variable
		$lNameErr = "* Last Name cannot be empty";
		
		# Set valid to FALSE
		$valid = FALSE;
	</pre>

	<p>If (else if) the email input is empty, repeat the above steps.</p>
	<pre>
	# Else if email is blank
	} elseif ( empty($_POST["email"]) ) {
		# Store the error message for email in a variable
		$emailErr = "* Email cannot be empty";

		# Set valid to FALSE
		$valid = FALSE;	
	</pre>

	<p>If (else if) the phone input is empty, repeat the above steps.</p>
	<pre>
	# Else if phone is blank
	} elseif ( empty($_POST["phone"]) ) {
		# Store the error message for phone number in a variable
		$phoneErr = "* Phone number cannot be empty";
		
		# Set valid to FALSE
		$valid = FALSE;	
	</pre>

	<p>Back to the main if block, else the form is valid. You can process the form. The below code first retrieves the input fields from the $_POST global variable and stores it in the variables you initialized above. Then, uses some built in functions to remove embedded, leading and trailing blanks.</p>
	<pre>
		# Else, it is valid	
	} else {

        # Retrieve the input from the form and store it in appropriate variables
        $fName = $_POST['fName'];
        $lName = $_POST['lName'];
        $email = $_POST['email'];
        $phone = $_POST['phone'];
        $province = $_POST['province'];
        $dob = $_POST['dob'];

        # Remove any embedded, leading and trailing blanks
        $fName = trim(str_replace(" ","",$fName));
        $lName = trim(str_replace(" ","",$lName));
        $email = trim(str_replace(" ","",$email));
        $phone = trim(str_replace(" ","",$phone));
	
	</pre>

	<p>Finally, build a meaningful message telling the user their form has been processed. Normally you would then connect to a database and insert the data, but that is beyond the scope of this lab (and course).</p>

	<pre>
			# Join first and last name together, storing the result in $fullName
			$fullName = $fName . " " . $lName;

			# Create a message using the $fullName variable
			$msg = "Hello " . $fullName . "&lt;br&gt; Your email is: $email &lt;br&gt;" . "You were born on: $dob &lt;br&gt;" . "Your phone is: $phone &lt;br&gt;" . "You live in $province &lt;br&gt;" . "This form has been processed using php.";

			# Normally at this point you would connect to a database and insert the data, but that is beyond the scope of this course
			}
		}
	?>	
	</pre>

	<h2>Modifying the HTML form to display the message</h2>
	<p>Insert the following code on a new line between the closing form tag and closing main tag.</p>
	<pre>
	&lt;?php echo $msg; ?&gt;
	</pre>

	<h2>Viewing your form on the server</h2>
	<p>Open a web browser and access form.php from your web server. If you recieve a 500 level error code, it means you have made a syntax error somewhere in your PHP. You could go through the lab line by line and compare, or you could look at Apache's error log. To do that, access the command line on your www instance and issue the following command:</p>

	<pre>
	sudo tail -f /var/log/apache2/error.log
	</pre>

	<p>Now refresh your webpage in the browser. You should see an error in your terminal indicating what line the syntax error is on. Look for missing semi-colons and misspelled variables, as they are common errors.</p>

	<h2>Completing the Lab</h2>
	<p>Upon completion of this lab you should have a functional form. Your page should validate using the <a href="https://validator.w3.org/">w3schools html validator</a> & <a href="https://jigsaw.w3.org/css-validator/">css validator</a>. To submit your lab you need to submit the code to your GitHub repo (which you did in already in the lab). Additionally, you need to submit a screenshot of it running your server to the assignment folder in eCentennial. Your page should look similar to the following:</p>
	<img src="images/lab10.png" alt="Lab 10 sample">
	<h2>Exploration Questions</h2>
	<ol>
		<li>What tag did you use to start your form?</li>
		<li>What is the difference between a form submitted through GET vs POST?</li>
		<li>What input types did we use for the form?</li>
		<li>How do you add different items to a select dropdown list?</li>
		<li>What is the difference between a submit button and a reset button?</li>
		<li>What does the float parameter do?</li>
		<li>What does setting the margin attribute to auto accomplish?</li>
		<li>What information does the action attribute provide to the form?</li>
		<li>What is a variable?</li>
		<li>What is the difference between dynamic and static typed variables?</li>
		<li>What global variable did you use in PHP to verify the method the form was requested with?</li>
		<li>What does the $_POST global variable contain?</li>
	</ol>
</main>
</html>